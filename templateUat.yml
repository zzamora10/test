pool:
  vmImage: ubuntu-latest

steps:
- task: CmdLine@2
  displayName: 'Install Newman'
  inputs:
    script: 'sudo npm install -g newman'

- task: CmdLine@2
  displayName: 'Install Newman-Reporter-htmlextra'
  inputs:
    script: 'sudo npm install -g newman-reporter-htmlextra'

- task: CmdLine@2
  displayName: 'Test Baja de Tasa'
  continueOnError: true
  inputs:
    script: 'newman run Baja_de_Tasa-TC.postman_collection.json -d baja_de_tasa-UAT.csv -e GIRU-UAT.postman_environment.json --reporters cli,junit,htmlextra --reporter-junit-export Results/junitReport.xml --reporter-htmlextra-export ./Results/index.html'
    workingDirectory: '$(System.DefaultWorkingDirectory)/'

- task: PublishTestResults@2
  inputs:
    testResultsFormat: 'JUnit'
    testResultsFiles: 'Results/*.xml'
    testRunTitle: 'Test Baja de Tasa Azure'

- task: UploadPostmanHtmlReport@1
  displayName: 'Upload Postman Html Report'
  inputs:
    cwd: '$(System.DefaultWorkingDirectory)/Results'
    tabName: 'Test Baja de Tasa Azure'